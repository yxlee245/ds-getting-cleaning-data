# Description of tidy version of the Human Activity Recognition (HAR) Dataset

## Steps to Obtain Tidy Dataset
_The following steps describe the process of getting and cleaning the dataset using the R programming language_
1. Read in `./uci_har_dataset/features.txt` using the `file` and `readLines` functions to get a character vector with each line in the file as one element. Split every element of the vector by the space character using the `strsplit` function. This will result in a list that contains a character vector of length 2 within every element. Use the `sapply` function to return only the second character object for every list element, and assign that to `feature_names`.
2. Remove empty parentheses and replace dashes with underscores for evey character object in `feature_names`, using the `gsub` function. As an example, the feature name "tBodyAcc-mean()-X" will be transformed to "tBodyAcc_mean_X" after this step.
3. Replace the first letter of the feature names using the `sub` function, such that "t" is replaced with "time_", and "f" is replaced with "freq_", if "t" or "f" are the first character of the feature name. Then, change the feature names to lowercase using the `tolower` function. Continuing from the example in step 2, the feature name "tBodyAcc_mean_X" will be further transformed to "time_bodyacc_mean_x".
4. Read in `./uci_har_dataset/train/X_train.txt` and `./uci_har_dataset/test/X_test.txt` using the `read.table` function, setting `header = FALSE`, `sep = ""` and `col.names = feature_names`. Assign the two resulting dataframes to `X_train` and `X_test` respectively.
5. Create a logical vector with the same length as `feature_names`, using the `grepl` function with `"_mean$|_mean_|_std"` as the pattern needed for the function, and assigning to `is_mean_or_std_name`. In `is_mean_or_std_name`, `TRUE` corresponds to a feature that is either the mean or standard deviation of a measurement, and `FALSE` otherwise.
6. Use `is_mean_or_std_name` to subset `X_train` and `X_test` by columns, and reassign to `X_train` and `X_test` respectively. `X_train` and `X_test` should now contain only mean and standard deviation of measurements.
7. Read in `./uci_har_dataset/train/y_train.txt` and `./uci_har_dataset/test/y_test.txt` using the `file` and `readLines` functions, and assign the resulting character vectors to `y_train` and `y_test` respectively. Use the `cbind` function to merge `X_train` with `y_train`, and `X_test` with `y_test`. The contents of `y_train` should end up at the right side of the contents of `X_train`, and the same applies to `X_test` and `y_test`. Assign the merged dataframes to `df_train` and `df_test` accordingly. Change the name of the last column to "activity_id" for both `df_train` and `df_test`, using the `names` function.
8. Read in `./uci_har_dataset/train/subject_train.txt` and `./uci_har_dataset/test/subject_test.txt` using the `file` and `readLines` functions, and assign the resulting character vectors to `subjects_train` and `subjects_test` respectively. Use the `cbind` function to merge `subjects_train` with `df_train`, and `subjects_test` with `df_test`. The contents of `subjects_train` should end up at the left side of the contents of `df_train`, and the same applies to `subjects_test` and `df_test`. Reassign the merged dataframes to `df_train` and `df_test` accordingly. Change the name of the first column to "subject_id" for both `df_train` and `df_test`, using the `names` function.
9. Merge `df_train` and `df_test` using the `rbind` function, and assign to `df_all`.
10. Read in `./uci_har_dataset/activity_labels.txt` using the `file` and `readLines` functions, and assign the resulting vector to `activity_labels`. Use the `sapply` and `strsplit` functions to separate the activity ID and description, and assign these to `activity_id` and `activity_desc` respectively. Create a dataframe with `activity_id` and `activity_desc`, and assign to `activity_df`.
11. Merge `df_all` and `activity_df` using the `merge` function, with arguments `by = "activity_id"` and `all = FALSE`, and reassign to `df_all`. Remove the "activity_id" column in `df_all` using the `names` function and `%in%` operator within `df_all[]`.
12. Convert `df_all` to a tibble using the `tbl_df` function (from the `dplyr` library). Use the `group_by` function on the resulting tibble, with `subject_id` and `activity_desc` as the arguments. The use the `summarize_at` function, with `feature_names[is_mean_or_std_name]` and `mean` function as the arguments. Assign the result of this step to `tibble_avg`.
13. Use the `sub` function, with `"^"` as the pattern and `"avg_` as the replacement string, on the column names in `tibble_avg`, starting from the third column. Continuing with the example in step 3, the column name "time_bodyacc_mean_x" will be transformed to "avg_time_bodyacc_mean_x".
14. Use the `write.csv` function to output `tibble_avg` to `./outputs/har_data_tidy.csv`, with `row.names = FALSE` as the additional argument.